{{extend 'layout.html'}}
<script type="text/javascript">
var game = new Phaser.Game(1000, 600, Phaser.CANVAS, 'phaser-example', { preload: preload, create: create, update: update });

function preload() {

    game.load.image('bg', '{{=URL('static','images/skies/deepblue.png')}}');
    game.load.bitmapFont('nokia16black', '{{=URL('static','images/fonts/bitmapFonts/nokia16black.png')}}','{{=URL('static','images/fonts/bitmapFonts/nokia16black.xml')}}');


}

var pass1;
var pass2;
var pass3;
var spriteDrop;
var text;
var bartext;
var infotext;

function create() {
    //Add background
    game.add.image(0,0,'bg');

    //Add a bar at the top
    var bar = game.add.graphics();
    bar.beginFill(0x000000, 0.2);
    bar.drawRect(0, 0, 1000, 100);
    var style = {font: "bold 32px Arial", fill: "#ffffff", boundsAlignH: "center",
    boundsAlignV: "middle"};
    bartext = game.add.text(0,0, "This shit will fuck you up!", style);//The text is positioned at 0, 0 aka the top
    bartext.setShadow(3, 3, 'rgba(0,0,0,0.5)', 2);
    bartext.setTextBounds(0, 0, 800, 100);//set the bounds to be from x0, y0 and be 800px wide by 100px high

    //Text info about the game
    var infotext = "Testa lösenorden 1-3 i lösenordstestaren genom att \n kopiera in dem med ctrl+c,\n Klicka på testa därefter,\n Du får testa så många gånger du vill, men minst en gång, \n innan du får välja mellan lösenorden.";
    var style = { font: "19px Arial", fill: "#ffffff", align: "left"};
    var t = game.add.text(game.world.centerX-350,122, infotext, style);

    //Randomgenerator of passwords,using phaser.js built in method for Math.random
    var passArray0 = [
        'Bajs123',
        'qwerty!',
        'LETMEINFFS',
        'p4s5w0rd!',
        '#¤horsie!'];
    var passArray1 = [
        '123qwerty',
        'Dvo0rak',
        'rJHK?ka',
        '20kEE$rAnd!',
        'p3n1s'];
    var passArray2 = [
        '!Panda',
        '?qwerty!',
        '!L3TMEINFFS09',
        'päs55w0rd!',
        'Nu;aäbh'];
    var randPass0 = this.game.rnd.pick(passArray0);
    var randPass1 = this.game.rnd.pick(passArray1);
    var randPass2 = this.game.rnd.pick(passArray2);
    var score = 0;
        /*if (!randPass0)
            return score;*/

    // award every unique letter until 5 repetitions
    var letters = new Object();
    for (var i = 0; i < randPass0.length; i++) {
        letters[randPass0[i]] = (letters[randPass0[i]] || 0) + 1;
        score += 5.0 / letters[randPass0[i]];
    }
    // bonus points for mixing it up
    var variations = {
        digits: /\d/.test(randPass0),
        lower: /[a-z]/.test(randPass0),
        upper: /[A-Z]/.test(randPass0),
        nonWords: /\W/.test(randPass0),
    }

    variationCount = 0;
    for (var check in variations) {
        variationCount += (variations[check] == true) ? 1 : 0;
    }
    score += (variationCount - 1) * 10;


    //End of randomgenerator of passwords


    //pass1 = game.add.bitmapText(532, 280, 'nokia16black', randPass0, 22);
    pass1 = game.add.text(532, 280, randPass0, 22);
    pass1 = game.add.text(450, 280, score, 22);
    pass1.inputEnabled = true;
    pass1.input.enableDrag();

    pass2 = game.add.text(532, 312, randPass1, 22);
    pass2.inputEnabled = true;
    pass2.input.enableDrag();

    pass3 = game.add.text(532, 340, randPass2, 22);
    pass3.inputEnabled = true;
    pass3.input.enableDrag();

    spriteDrop = game.add.bitmapText(532, 420, 'nokia16black','Drop Here!');
    spriteDrop.inputEnabled = true;
    //spriteDrop.input.enableDrag();
    //We don't want this to move

    text = game.add.text(16, 560, 'Drag the sprites. Overlapping: false', { fill: '#ffffff' });

}



function update() {

    if (checkOverlap(pass1, spriteDrop))
    {
        text.text= 'bajs';

    }
    else if (checkOverlap(pass2, spriteDrop))
    {
        text.text = 'Drag the sprites. Overlapping: true';
    }
    else if (checkOverlap(pass3, spriteDrop))
    {
        text.text = 'Drag the sprites. Overlapping: true';
    }
    else
    {
        text.text = 'Drag the sprites. Overlapping: false';
    }

}

function checkOverlap(spriteA, spriteB) {

    var boundsA = spriteA.getBounds();
    var boundsB = spriteB.getBounds();

    return Phaser.Rectangle.intersects(boundsA, boundsB);

}

</script>

